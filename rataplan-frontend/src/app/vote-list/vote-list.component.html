<div class="center" *ngrxLet="{busy: busy$, delayedBusy: delayedBusy$, created: created$, consigned: consigned$, consignedNonExpired: consignedNonExpired$, participated: participated$} as state">
  <mat-tab-group dynamicHeight [selectedIndex]="state.consignedNonExpired ? 1 : null">
    <mat-tab>
      <div>
        <ng-template mat-tab-label>
          <span class="centered">Erstellt</span>
        </ng-template>
        <div class="left-bound">
          <mat-card appearance="outlined" class="width" *ngFor="let vote of state.created">
            <mat-card-header>
              <mat-card-title [textContent]="vote.title"></mat-card-title>
              <mat-card-subtitle>Deadline {{ vote.deadline | date:'dd.LL.yyyy' }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content [textContent]="vote.description ?? ''"></mat-card-content>
            <mat-card-actions>
              <a
                mat-raised-button
                color="primary"
                [routerLink]="['/vote', vote.participationToken || vote.id]"
              >
                Anzeigen
              </a>
              <a
                *ngIf="!vote.expired && vote.editToken"
                mat-raised-button
                color="primary"
                [routerLink]="['/vote', 'edit', vote.editToken]"
              >
                Editieren
              </a>
            </mat-card-actions>
          </mat-card>
        </div>
      </div>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
      <span
        class="centered" [matBadge]="state.consignedNonExpired" matBadgeOverlap="false"
        [matBadgeHidden]="state.consignedNonExpired == 0"
        matBadgeColor="warn"
      >Einladungen</span>
      </ng-template>
      <div class="left-bound">
        <mat-card appearance="outlined" class="width" *ngFor="let vote of state.consigned">
          <mat-card-header>
            <mat-card-title [textContent]="vote.title"></mat-card-title>
            <mat-card-subtitle>Deadline {{ vote.deadline | date:'dd.LL.yyyy' }}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content [textContent]="vote.description ?? ''"></mat-card-content>
          <mat-card-actions>
            <a
              mat-raised-button
              color="primary"
              [routerLink]="['/vote', vote.participationToken || vote.id]"
            >
              Anzeigen
            </a>
          </mat-card-actions>
        </mat-card>
      </div>
    </mat-tab>
    <mat-tab>
      <ng-template mat-tab-label>
        <span class="centered">Teilnahmen</span>
      </ng-template>
      <div class="left-bound">
        <mat-card appearance="outlined" class="width" *ngFor="let vote of state.participated">
          <mat-card-header>
            <mat-card-title [textContent]="vote.title"></mat-card-title>
            <mat-card-subtitle>Deadline {{ vote.deadline | date:'dd.LL.yyyy' }}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content [textContent]="vote.description ?? ''"></mat-card-content>
          <mat-card-actions>
            <a
              mat-raised-button
              color="primary"
              [routerLink]="['/vote', vote.participationToken || vote.id]"
            >
              Anzeigen
            </a>
          </mat-card-actions>
        </mat-card>
      </div>
    </mat-tab>
  </mat-tab-group>
  <mat-spinner class="centered" *ngIf="delayedBusy$ | async"></mat-spinner>
</div>